{"version":3,"file":"fireworks.js","sources":["../ts/util.ts","../ts/particle.ts","../ts/things.ts","../ts/fireworks.ts"],"sourcesContent":["/**\n * Returns a random number between min and max\n * @param {number} min minimum number\n * @param {number} max maximum number\n */\nexport function random(min: number, max: number): number {\n  return Math.random() * (max - min) + min\n}\n\n/**\n * Tau is Pi multiplied by two.\n */\nexport const TAU = Math.PI * 2\n","import { random, TAU } from './util'\n\nexport type Point = {\n  x: number\n  y: number\n}\n\ntype ParticleOptions = {\n  position: Point\n  isRocket?: boolean\n  hue?: number\n  brightness?: number\n}\n\nexport default class Particle {\n  public isRocket: boolean\n  private positions: Point[]\n  private position: Point\n  private velocity: Point\n  private resistance: number\n  private gravity: number\n  private fade: number\n  private shrink: number\n  private size: number\n  private alpha: number\n  private hue: number\n  private brightness: number\n\n  constructor({\n    isRocket = false,\n    hue = random(1, 360),\n    brightness = random(50, 60),\n    position,\n  }: ParticleOptions) {\n    this.isRocket = isRocket\n    this.position = position\n    this.positions = [this.position, this.position, this.position]\n\n    if (this.isRocket) {\n      this.velocity = {\n        x: random(-3, 3),\n        y: random(-7, -3),\n      }\n      this.shrink = 0.999\n      this.resistance = 1\n    } else {\n      const angle = random(0, TAU)\n      const speed = Math.cos(random(0, TAU)) * 15\n      this.velocity = {\n        x: Math.cos(angle) * speed,\n        y: Math.sin(angle) * speed,\n      }\n      this.shrink = random(0, 0.05) + 0.93\n      this.resistance = 0.92\n    }\n\n    this.gravity = 0.01\n    this.size = 3\n    this.alpha = 1\n    this.fade = 0\n    this.hue = hue\n    this.brightness = brightness\n  }\n\n  /**\n   * Clones a particle, same hue/brightness/position\n   * @returns {Particle} new particle\n   */\n  clone(): Particle {\n    return new Particle({\n      position: {\n        x: this.position.x,\n        y: this.position.y,\n      },\n      hue: this.hue,\n      brightness: this.brightness,\n    })\n  }\n\n  /**\n   * Checks if a particle should be removed.\n   * @param particle particle to check\n   * @returns {boolean} whether or not the particle should be removed.\n   */\n  shouldRemove(cw: number, ch: number): boolean {\n    if (this.alpha <= 0.1 || this.size <= 1) {\n      return true\n    }\n\n    if (this.position.x > cw || this.position.x < 0) {\n      return true\n    }\n\n    if (this.position.y > ch || this.position.y < 0) {\n      return true\n    }\n\n    return false\n  }\n\n  /**\n   * Determines if a rocket should explode - based on explosionHeight & explosionChance\n   * @param {Particle} particle rocket to check\n   * @returns {boolean} whether or not the rocket shoudl explode\n   */\n  shouldExplode(maxHeight: number, minHeight: number, chance: number): boolean {\n    if (!this.isRocket) {\n      return false\n    }\n\n    // make sure things explode once they hit explosionMaxHeight (90% default) of height\n    if (this.position.y <= maxHeight) {\n      return true\n    }\n\n    // make sure particle has reached explosionMinHeight (20% default) before explosion chance.\n    if (this.position.y >= minHeight) {\n      return false\n    }\n\n    return random(0, 1) <= chance\n  }\n\n  /**\n   * Update the position of the particle.\n   * For rockets, has a potential to explode.\n   */\n  update(): void {\n    this.positions.pop()\n    this.positions.unshift({ x: this.position.x, y: this.position.y })\n    this.velocity.x *= this.resistance\n    this.velocity.y *= this.resistance\n    this.velocity.y += this.gravity\n    this.position.x += this.velocity.x\n    this.position.y += this.velocity.y\n    this.size *= this.shrink\n    this.alpha -= this.fade\n  }\n\n  /**\n   * Renders a particle. Returns whether or not it should exist.\n   * @param {CanvasRenderingContext2D} ctx canvas context\n   */\n  draw(ctx: CanvasRenderingContext2D): void {\n    const lastPosition = this.positions[this.positions.length - 1]\n    ctx.beginPath()\n    ctx.moveTo(lastPosition.x, lastPosition.y)\n    ctx.lineTo(this.position.x, this.position.y)\n    ctx.lineWidth = this.size\n    ctx.lineCap = 'round'\n    ctx.strokeStyle = `hsla(${this.hue}, 100%, ${this.brightness}%, ${this.alpha})`\n    ctx.stroke()\n  }\n}\n","import Particle, { Point } from './particle'\nimport { random } from './util'\n\ntype ThingOptions = {\n  cw: number\n  ch: number\n  maxRockets: number\n  numParticles: number\n  rocketInitialPoint: number\n  cannons: Point[]\n}\n\nexport default class Things {\n  private _set: Set<Particle>\n  private maxRockets: number\n  private numParticles: number\n  public cw: number\n  public ch: number\n  public rockets: number\n  public rocketInitialPoint: number\n  private cannons: Point[]\n\n  constructor({\n    maxRockets,\n    numParticles,\n    cw,\n    ch,\n    rocketInitialPoint,\n    cannons,\n  }: ThingOptions) {\n    this._set = new Set()\n    this.rockets = 0\n    this.maxRockets = maxRockets\n    this.numParticles = numParticles\n    this.cw = cw\n    this.ch = ch\n    this.rocketInitialPoint = rocketInitialPoint\n\n    this.cannons = cannons\n\n    if (this.rocketInitialPoint) {\n      this.cannons.push({ x: this.rocketInitialPoint, y: this.ch })\n    }\n  }\n\n  size(): number {\n    return this._set.size\n  }\n\n  entries(): Set<Particle> {\n    return this._set\n  }\n\n  clear(): void {\n    this._set.clear()\n    this.rockets = 0\n  }\n\n  delete(thing: Particle): void {\n    this._set.delete(thing)\n    if (thing.isRocket) this.rockets--\n  }\n\n  add(thing: Particle): void {\n    this._set.add(thing)\n  }\n\n  /**\n   * Turn a particle into many particles exploding in different directions.\n   * Rocket is deleted afterwards,\n   * @param {Particle} particle the rocket to start from.\n   */\n  explode(particle: Particle): void {\n    for (let i = 0; i < this.numParticles; i += 1) {\n      this.add(particle.clone())\n    }\n    this.delete(particle)\n  }\n\n  /**\n   * Spawns a single rocket\n   */\n  spawnRocket(): void {\n    this.rockets++\n    const cannonIndex = Math.floor(random(0, this.cannons.length))\n    const cannon = this.cannons[cannonIndex] || ({} as Point)\n    this.add(\n      new Particle({\n        isRocket: true,\n        position: {\n          ...cannon,\n          ...(cannon.x == null && { x: random(0, this.cw) }),\n          ...(cannon.y == null && { y: this.ch }),\n        },\n      })\n    )\n  }\n\n  /**\n   * if we have less than required number of rockets, spawn one.\n   * this mutates the Set, adding more rockets.\n   */\n  spawnRockets(): void {\n    if (this.rockets < this.maxRockets) {\n      this.spawnRocket()\n    }\n  }\n}\n","import { Point } from './particle'\nimport Things from './things'\n\ntype Options = {\n  maxRockets?: number\n  numParticles?: number\n  explosionMinHeight?: number\n  explosionMaxHeight?: number\n  explosionChance?: number\n  rocketSpawnInterval?: number\n  width?: number\n  height?: number\n  rocketInitialPoint?: number\n  cannons?: Point[]\n}\n\nexport default class Fireworks {\n  private container: HTMLElement\n  private maxRockets: number\n  private rocketSpawnInterval: number\n  private cw: number\n  private ch: number\n  private minH: number\n  private maxH: number\n  private chance: number\n  private things: Things\n  private interval: number\n  private rafInterval: number\n\n  private finishCallbacks: Array<() => void> = []\n\n  private canvas: HTMLCanvasElement\n  private ctx: CanvasRenderingContext2D\n  private pixelRatio: number\n\n  constructor(\n    container: HTMLElement,\n    {\n      rocketSpawnInterval = 150,\n      maxRockets = 3,\n      numParticles = 100,\n      explosionMinHeight = 0.2,\n      explosionMaxHeight = 0.9,\n      explosionChance = 0.08,\n      width = container.clientWidth,\n      height = container.clientHeight,\n      rocketInitialPoint = null,\n      cannons = [],\n    }: Options = {}\n  ) {\n    this.container = container\n    this.rocketSpawnInterval = rocketSpawnInterval\n    this.maxRockets = maxRockets\n    this.cw = width\n    this.ch = height\n    this.maxH = this.ch * (1 - explosionMaxHeight)\n    this.minH = this.ch * (1 - explosionMinHeight)\n    this.chance = explosionChance\n    this.pixelRatio = window.devicePixelRatio || 1\n    this.canvas = document.createElement('canvas')\n    this.ctx = this.canvas.getContext('2d')\n\n    container.appendChild(this.canvas)\n\n    this.things = new Things({\n      maxRockets: this.maxRockets,\n      numParticles,\n      cw: this.cw,\n      ch: this.ch,\n      rocketInitialPoint,\n      cannons,\n    })\n    this.updateDimensions()\n  }\n\n  destroy(): void {\n    this.canvas.parentElement.removeChild(this.canvas)\n    window.clearInterval(this.interval)\n    window.cancelAnimationFrame(this.rafInterval)\n  }\n\n  start(): () => void {\n    if (this.maxRockets > 0) {\n      this.interval = window.setInterval(\n        () => this.things.spawnRockets(),\n        this.rocketSpawnInterval\n      )\n      this.rafInterval = window.requestAnimationFrame(() => this.update())\n    }\n    return (): void => this.stop()\n  }\n\n  private updateDimensions(): void {\n    this.canvas.width = this.cw * this.pixelRatio\n    this.canvas.height = this.ch * this.pixelRatio\n    this.canvas.style.width = `${this.cw}px`\n    this.canvas.style.height = `${this.ch}px`\n    this.ctx.scale(this.pixelRatio, this.pixelRatio)\n    this.things.cw = this.cw\n    this.things.ch = this.ch\n  }\n\n  setSize(width: number, height: number): void {\n    this.cw = width\n    this.ch = height\n    this.updateDimensions()\n  }\n\n  resetSize(): void {\n    this.cw = this.container.clientWidth\n    this.ch = this.container.clientHeight\n    this.updateDimensions()\n  }\n\n  stop(): void {\n    window.clearInterval(this.interval)\n    this.interval = null\n  }\n\n  kill(): void {\n    this.things.clear()\n    this.stop()\n    window.cancelAnimationFrame(this.rafInterval)\n    this._finish()\n  }\n\n  fire(): void {\n    this.things.spawnRocket()\n    if (!this.rafInterval) {\n      this.rafInterval = window.requestAnimationFrame(() => this.update())\n    }\n  }\n\n  onFinish(cb: () => void): void {\n    this.finishCallbacks.push(cb)\n  }\n\n  private _clear(force = false): void {\n    this.ctx.globalCompositeOperation = 'destination-out'\n    this.ctx.fillStyle = `rgba(0, 0, 0 ${force ? '' : ', 0.5'})`\n    this.ctx.fillRect(0, 0, this.cw, this.ch)\n    this.ctx.globalCompositeOperation = 'lighter'\n  }\n\n  private _finish(): void {\n    this._clear(true)\n    this.rafInterval = null\n    this.finishCallbacks.forEach((cb) => cb())\n  }\n\n  update(): void {\n    this._clear()\n\n    for (const particle of this.things.entries()) {\n      particle.draw(this.ctx)\n      particle.update()\n\n      if (particle.shouldRemove(this.cw, this.ch)) {\n        this.things.delete(particle)\n      } else if (particle.shouldExplode(this.maxH, this.minH, this.chance)) {\n        this.things.explode(particle)\n      }\n    }\n\n    if (this.interval || this.things.size() > 0) {\n      this.rafInterval = window.requestAnimationFrame(() => this.update())\n    } else {\n      this._finish()\n    }\n  }\n}\n"],"names":[],"mappings":"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"}